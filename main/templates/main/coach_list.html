{% extends "base.html" %}
{% block title %}Daftar Pelatih{% endblock title %}

{% block content %}
<div style="padding: 20px; max-width: 1200px; margin: auto;">

  <div id="page-header" 
       style="margin-bottom: 20px;">
    
    <a href="{% url 'home' %}"
       style="display:inline-flex; align-items:center; gap:8px;
              padding:10px 18px; background: linear-gradient(135deg,#003F3F 0%,#005757 100%);
              color:#fff; text-decoration:none; border-radius:10px; font-weight:500;
              box-shadow:0 6px 18px rgba(0,63,63,0.18);">
      <span style="font-size:18px;">←</span> Kembali
    </a>
    
    <h2 style="margin-top: 16px; font-size: 22px; color:#003F3F; text-align: center;">
      Daftar Pelatih
    </h2>
  </div>

  <div id="filter-box" 
       style="background: #fff; padding: 18px; border-radius: 12px; margin-bottom: 28px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
    <form method="GET" style="display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
      <input type="text" name="q" placeholder="Cari nama pelatih..."
             value="{{ request.GET.q }}"
             style="flex:1; min-width:200px; padding:10px; border:1px solid #e6e6e6; border-radius:8px;">

      <select name="sport" style="padding:10px; border:1px solid #e6e6e6; border-radius:8px;">
        <option value="">-- Semua Olahraga --</option>
        {% for cat in categories %}
          <option value="{{ cat.id }}" {% if request.GET.sport == cat.id|stringformat:"s" %}selected{% endif %}>
            {{ cat.name }}
          </option>
        {% endfor %}
      </select>

      <select name="area" style="padding:10px; border:1px solid #e6e6e6; border-radius:8px;">
        <option value="">-- Semua Area --</option>
        {% for area in areas %}
          <option value="{{ area.id }}" {% if request.GET.area == area.id|stringformat:"s" %}selected{% endif %}>
            {{ area.name }}
          </option>
        {% endfor %}
      </select>

      <button type="submit" style="padding:10px 18px; background: linear-gradient(135deg,#003F3F 0%,#005757 100%); color:#fff; border:none; border-radius:8px; cursor:pointer;">
        Cari
      </button>

      <a href="{% url 'coach_list' %}" style="padding:10px 14px; background:#6c757d; color:#fff; border-radius:8px; text-decoration:none;">
        Reset
      </a>
    </form>
  </div>

  <div id="coach-grid" 
       style="display:grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap:20px;">
    
    {% for coach in coaches %}
    <div style="border:1px solid #eef2f2; border-radius:12px; overflow:hidden; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.04); transition:transform .18s;">
      
      {% if coach.profile_picture %}
        <img src="{{ coach.profile_picture.url }}" alt="Foto {{ coach.user.get_full_name }}"
             style="width:100%; height:200px; object-fit:cover;">
      {% elif coach.profile_picture_url %}
        <img src="{{ coach.profile_picture_url }}" alt="Foto {{ coach.user.get_full_name }}"
             style="width:100%; height:200px; object-fit:cover;">
      {% else %}
        <div style="width:100%; height:200px; display:flex; align-items:center; justify-content:center; background:#f5f7f7; color:#999;">
          Tidak ada gambar
        </div>
      {% endif %}

      <div style="padding:18px;">
        <h3 style="margin:0 0 8px; color:#003F3F; font-size:18px;">
          {{ coach.user.get_full_name|default:coach.user.username }}
        </h3>

        <div style="margin:10px 0; color:#475569; font-size:14px;">
          <p style="margin:4px 0;"><strong>Umur:</strong> {{ coach.age|default:"-" }} tahun</p>
          <p style="margin:4px 0;"><strong>Olahraga:</strong> {{ coach.main_sport_trained.name }}</p>
          <p style="margin:4px 0;"><strong>Tarif:</strong> Rp {{ coach.rate_per_hour|floatformat:0 }}/jam</p>
          <p style="margin:4px 0;"><strong>Area Layanan:</strong>
            {% for area in coach.service_areas.all %}{{ area.name }}{% if not forloop.last %}, {% endif %}{% empty %}-{% endfor %}
          </p>
        </div>

        <p style="color:#6b7280; font-size:13px; display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;">
          {{ coach.experience_desc|default:"Belum ada deskripsi pengalaman." }}
        </p>

        <a href="{% url 'coach_detail_public' coach.id %}" 
           style="display:block; margin-top:14px; padding:12px 14px; background: linear-gradient(135deg,#003F3F 0%,#005757 100%); color:#fff; text-align:center; text-decoration:none; border-radius:8px; font-weight:600;">
          Lihat Detail
        </a>
      </div>
    </div>
    {% empty %}
    <div style="grid-column:1/-1; text-align:center; padding:40px; color:#666;">
      <p>Belum ada pelatih yang tersedia.</p>
    </div>
    {% endfor %}
  </div>
</div>

{% if coaches.has_other_pages %}
  <div style="margin-top: 40px; text-align: center;">
    <div style="display: inline-flex; gap: 8px; align-items: center; background: #fff; padding: 12px 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
      
      {% if coaches.has_previous %}
        <a href="?page={{ coaches.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sport %}&sport={{ request.GET.sport }}{% endif %}{% if request.GET.area %}&area={{ request.GET.area }}{% endif %}"
           style="padding: 10px 16px; background: #003F3F; color: white; text-decoration: none; border-radius: 8px; font-weight: 500; transition: all 0.3s ease;">
          ← Prev
        </a>
      {% else %}
        <span style="padding: 10px 16px; background: #e5e7eb; color: #9ca3af; border-radius: 8px; font-weight: 500;">← Prev</span>
      {% endif %}

      <span style="padding: 10px 16px; background: #f8fafc; color: #003F3F; border-radius: 8px; font-weight: 600; border: 1px solid #e5e7eb;">
        Halaman {{ coaches.number }} dari {{ coaches.paginator.num_pages }}
      </span>

      {% if coaches.has_next %}
        <a href="?page={{ coaches.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sport %}&sport={{ request.GET.sport }}{% endif %}{% if request.GET.area %}&area={{ request.GET.area }}{% endif %}"
           style="padding: 10px 16px; background: #003F3F; color: white; text-decoration: none; border-radius: 8px; font-weight: 500; transition: all 0.3s ease;">
          Next →
        </a>
      {% else %}
        <span style="padding: 10px 16px; background: #e5e7eb; color: #9ca3af; border-radius: 8px; font-weight: 500;">Next →</span>
      {% endif %}
      
    </div>
  </div>
  {% endif %}
</div>

<style>
  #coach-grid > div:hover { 
    transform: translateY(-6px); 
    box-shadow:0 12px 30px rgba(0,0,0,0.08) !important; 
  }
  
  a[style*="linear-gradient(135deg,#003F3F"] { 
    transition: transform .12s, box-shadow .12s; 
  }
  
  a[style*="linear-gradient(135deg,#003F3F"]:hover { 
    transform: translateY(-3px); 
    box-shadow:0 10px 24px rgba(0,63,63,0.14) !important; 
  }

  #page-header a:hover {
    transform: none !important;
  }

    a[style*="background: #003F3F"]:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,63,63,0.3);
  }
</style>
{% endblock content %}